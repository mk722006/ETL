{
	"jobConfig": {
		"name": "Fetch_Job",
		"description": "",
		"role": "arn:aws:iam::506572490930:role/my-glue",
		"command": "pythonshell",
		"version": "3.0",
		"runtime": null,
		"workerType": null,
		"numberOfWorkers": null,
		"maxCapacity": 0.0625,
		"jobRunQueuingEnabled": false,
		"maxRetries": 0,
		"timeout": 2880,
		"maxConcurrentRuns": 1,
		"security": "none",
		"scriptName": "Fetch_Job.py",
		"scriptLocation": "s3://aws-glue-assets-506572490930-ap-south-1/scripts/",
		"language": "python-3.9",
		"spark": false,
		"jobParameters": [],
		"tags": [],
		"jobMode": "DEVELOPER_MODE",
		"createdOn": "2024-08-21T14:40:05.206Z",
		"developerMode": true,
		"connectionsList": [],
		"temporaryDirectory": "s3://aws-glue-assets-506572490930-ap-south-1/temporary/",
		"glueHiveMetastore": true,
		"etlAutoTuning": false,
		"observabilityMetrics": false,
		"pythonShellPrebuiltLibraryOption": "analytics",
		"flexExecution": false,
		"minFlexWorkers": null,
		"maintenanceWindow": null,
		"pythonPath": null
	},
	"hasBeenSaved": false,
	"usageProfileName": null,
	"script": "import boto3\r\nimport pandas as pd\r\nimport requests\r\nfrom io import StringIO\r\n\r\ndef download_google_sheet(url):\r\n    \"\"\"Download the Google Sheet as CSV.\"\"\"\r\n    response = requests.get(url)\r\n    response.raise_for_status()\r\n    return StringIO(response.text)\r\n\r\ndef upload_to_s3(bucket_name, key, file_content):\r\n    \"\"\"Upload file content to S3 bucket.\"\"\"\r\n    s3_client = boto3.client('s3')\r\n    s3_client.put_object(Bucket=bucket_name, Key=key, Body=file_content)\r\n\r\ndef main():\r\n    # Google Sheets URL (replace with the actual export URL)\r\n    google_sheets_url = 'https://docs.google.com/spreadsheets/d/1zH0x0ZmBRIdJ0SrDcuWWma_82DfNy7qsyrWV4D_XVgc/export?format=csv'\r\n    \r\n    # S3 Bucket and Key\r\n    bucket_name = 'rawfolder3327'\r\n    s3_key = 'data.csv'\r\n    \r\n    # Download Google Sheet as CSV\r\n    csv_file_content = download_google_sheet(google_sheets_url)\r\n    \r\n    # Upload CSV to S3\r\n    upload_to_s3(bucket_name, s3_key, csv_file_content.getvalue())\r\n\r\nif __name__ == \"__main__\":\r\n    main()\r\n"
}